SELECT 
	CODPROD,
	DESCPROD,
	IDPROD, 
	IDSKU, 
	RECNOSB5,
	RECNOWS5,
	RECNOWS6
FROM
(
	SELECT 
		B5.B5_COD CODPROD,
		B5.B5_CEME DESCPROD,
		B5.B5_XIDPROD IDPROD, 
		B5.B5_XIDSKU IDSKU, 
		B5.R_E_C_N_O_ RECNOSB5,
		0 RECNOWS5,
		0 RECNOWS6
	FROM 
		SB5010 B5 
		INNER JOIN DA1010 DA1 ON DA1.DA1_FILIAL = '01 ' AND DA1.DA1_CODPRO = B5.B5_COD AND DA1.DA1_CODTAB = '001' AND DA1.DA1_ENVECO = '2' AND DA1.D_E_L_E_T_ = '' 
		INNER JOIN SB2010 B2 ON B2.B2_FILIAL = '0101' AND B2.B2_COD = B5.B5_COD AND B2.B2_LOCAL = '05' AND B2.B2_MSEXP <> '' AND B2.D_E_L_E_T_ = ''  
	WHERE 
		B5.B5_FILIAL = '0101' AND 
		B5.B5_XUSAECO = 'S' AND 
		B5.B5_XENVECO = '2' AND 
		B5.B5_XENVSKU = '2' AND 
		B5.B5_XATVPRD = '1' AND 
		B5.B5_STATUS = 'A' AND 
		B5.D_E_L_E_T_ = '' 
	UNION 
	SELECT 
		WS6.WS6_CODSKU CODPROD,
		B1.B1_DESC DESCPROD,
		WS5.WS5_IDPROD IDPROD, 
		WS6.WS6_IDSKU IDSKU, 
		0 RECNOSB5,
		WS5.R_E_C_N_O_ RECNOWS5,
		WS6.R_E_C_N_O_ RECNOWS6
	FROM 
		WS5010 WS5 
		INNER JOIN WS6010 WS6 ON WS6.WS6_FILIAL = '' AND WS6.WS6_CODPRD = WS5.WS5_CODPRD AND WS6.WS6_IDSKU <> '' AND WS6.WS6_ATVSKU IN('1','2') AND WS6.D_E_L_E_T_ = ''
		INNER JOIN SB1010 B1 ON B1.B1_FILIAL = '0101' AND B1.B1_COD = WS6.WS6_CODSKU AND B1.D_E_L_E_T_ = ''
		INNER JOIN DA1010 DA1 ON DA1.DA1_FILIAL = '01 ' AND DA1.DA1_CODPRO = WS6.WS6_CODSKU AND DA1.DA1_CODTAB = '001' AND DA1.DA1_ENVECO = '2' AND DA1.D_E_L_E_T_ = '' 
		INNER JOIN SB2010 B2 ON B2.B2_FILIAL = '0101' AND B2.B2_COD = WS6.WS6_CODSKU AND B2.B2_LOCAL = '05' AND B2.B2_MSEXP <> '' AND B2.D_E_L_E_T_ = ''  
	WHERE 
		WS5.WS5_FILIAL = '' AND 
		WS5.WS5_USAECO = 'S' AND 
		WS5.WS5_ENVECO = '2' AND
		WS5.WS5_ATVPRD = '1' AND  
		WS5.WS5_STATUS = 'A' AND 
		WS5.D_E_L_E_T_ = '' 
)ATVPRD
ORDER BY IDPROD,IDSKU


--SELECT * FROM DA1010 WHERE DA1_ENVECO = '1'
--SELECT * FROM SB2010 WHERE B2_MSEXP <> ''