SELECT 
	PRODUTO,
	TIPO,
	DESCRICAO,
	UM,
	[01] AS JANEIRO,
	[02] AS FEVREIRO,
	[03] AS MARÇO,
	[04] AS ABRIL,
	[05] AS MAIO,
	[06] AS JUNHO,
	[07] AS JULHO,
	[08] AS AGOSTO,
	[09] AS SETEMBRO,
	[10] AS OUTUBRO,
	[11] AS NOVEMBRO,
	[12] AS DEZEMBRO
FROM
	(
		SELECT 
			D1.D1_COD PRODUTO,
			B1.B1_TIPO TIPO ,
			B1.B1_DESC DESCRICAO,
			B1.B1_UM UM, 
			SUBSTRING(D1.D1_EMISSAO,5,2) MES,
			SUM(D1.D1_QUANT) QUANTIDADE
		FROM
			SD1010 D1
			INNER JOIN SB1010 B1 ON B1.B1_FILIAL = ' ' AND B1.B1_COD = D1.D1_COD AND B1.B1_TIPO = 'PA' AND  B1.D_E_L_E_T_ = ''
		WHERE
			D1.D1_FILIAL = '01' AND
			D1.D1_EMISSAO BETWEEN '20160101' AND '20161231' AND 
			D1.D1_COD BETWEEN '          ' AND 'ZZZZZZZZZZZZZZZ' AND 
			D1.D_E_L_E_T_ = '' 
		GROUP BY D1.D1_COD,	B1.B1_DESC, B1.B1_TIPO,	B1.B1_DESC,	B1.B1_UM,SUBSTRING(D1.D1_EMISSAO,5,2)
) AS PROD1
PIVOT (SUM(QUANTIDADE)
FOR MES IN([01],[02],[03],[04],[05],[06],[07],[08],[09],[10],[11],[12]) ) AS PROD2
ORDER BY PRODUTO