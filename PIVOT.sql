SELECT 
	PRODUTO, 
	COALESCE([000],0) AS VISITANTES_0,
	COALESCE([001],0) AS COMUM_1,
	COALESCE([002],0) AS REVENDA_SP_2,
	COALESCE([003],0) AS FINAL_PJ_3,                              
	COALESCE([004],0) AS REV_N_NO_4,                                
	COALESCE([005],0) AS REV_S_SE_5,                                
	COALESCE([006],0) AS REV_VET_SP_6,                              
	COALESCE([007],0) AS FINAL_VET_7,                               
	COALESCE([008],0) AS REV_VET_N_NE_CO_8,
	COALESCE([009],0) AS REV_VET_S_SE_9,
	COALESCE([010],0) AS REV_VET_RJ_10,
	COALESCE([012],0) AS FINAL_PF_12,
	COALESCE([013],0) AS FINAL_PS_13
FROM 
(
	SELECT 
		DA1.DA1_CODPRO PRODUTO,
		GRUPO.value GRUPO,
		MAX(DA1.DA1_PRCVEN) QUANTIDADE
	FROM 
		DA1040 DA1 
		INNER JOIN DA0040 DA0 ON DA0.DA0_CODTAB = DA1.DA1_CODTAB AND DA0.DA0_XGRPPR <> '' AND DA0.D_E_L_E_T_ = ''
		CROSS APPLY STRING_SPLIT(DA0.DA0_XGRPPR,',') GRUPO 
	WHERE 
		DA1.DA1_FILIAL = '0404' AND 
		DA1.DA1_CODPRO = '12231' AND 
		DA1.DA1_PRCVEN > 0 AND 
		DA1.D_E_L_E_T_ = ''
	GROUP BY DA0.DA0_XGRPPR,DA1.DA1_CODPRO,DA1.DA1_PRCVEN,GRUPO.value
) GRUPO_CLIENTES
PIVOT ( MAX(QUANTIDADE)
FOR GRUPO IN([000],[001],[002],[003],[004],[005],[006],[007],[008],[009],[010],[012],[013]) ) PIVOTTABLE
