SELECT 
	PEDIDO,CLIENTE,LOJACLI,TRANSP,DTAEMISSAO,VENDEDOR,CONDPAG,
	ITEM,PRODUTO,DESCPROD,PACK,ARMAZEM,DTAENTREGA,
	PRCVEN,SUM(QTDVEND) QTDVEND,SUM(QTDFATU) QTDFATU,
	SUM(QTDCANCE) QTDCANCE,SUM(QTDLIB) QTDLIB,
	SUM(QTDVEND - QTDLIB - QTDFATU ) SALDO
FROM
	(
		SELECT 
			SC5.C5_NUM PEDIDO,SC5.C5_CLIENTE CLIENTE,SC5.C5_LOJACLI LOJACLI,
			SC5.C5_TRANSP TRANSP,SC5.C5_EMISSAO DTAEMISSAO,SC5.C5_VEND1 VENDEDOR,
			SC5.C5_CONDPAG CONDPAG,SC6.C6_ITEM ITEM, SC6.C6_PRODUTO PRODUTO,
			SC6.C6_DESCRI DESCPROD,SC6.C6_XPACK PACK,SC6.C6_LOCAL ARMAZEM,
			SC6.C6_ENTREG DTAENTREGA,SC6.C6_PRCVEN PRCVEN,
			SC6.C6_QTDVEN QTDVEND,0 QTDFATU,0 QTDCANCE,0 QTDLIB, 0 SALDO
		FROM
			SC5010 SC5
			INNER JOIN SC6010 SC6 ON SC6.C6_FILIAL = SC5.C5_FILIAL AND SC6.C6_NUM = SC5.C5_NUM AND 
			SC6.C6_PRODUTO BETWEEN '' AND 'ZZZZZZZZZZZZZZZZZZZZ' AND SC6.C6_ENTREG BETWEEN '20130101' AND '20130314' AND 
			SC6.C6_BLQ <> 'R' AND SC6.C6_XCANC <> 'S' AND SC6.D_E_L_E_T_ = ''
		WHERE	
		SC5.C5_FILIAL = '05' AND 
		SC5.C5_NUM BETWEEN '' AND 'ZZZZZZ' AND
		SC5.C5_CLIENTE BETWEEN '' AND 'ZZZZZZZZ' AND
		SC5.C5_LOJACLI BETWEEN '' AND 'ZZ' AND 
		SC5.C5_VEND1 BETWEEN '000001' AND '000001' AND 
		SC5.D_E_L_E_T_ = ''
		GROUP BY 
			SC5.C5_NUM, SC5.C5_CLIENTE, SC5.C5_LOJACLI,
			SC5.C5_TRANSP, SC5.C5_EMISSAO, SC5.C5_VEND1,
			SC5.C5_CONDPAG, SC6.C6_ITEM, SC6.C6_PRODUTO,
			SC6.C6_DESCRI, SC6.C6_XPACK,SC6.C6_LOCAL,SC6.C6_ENTREG,
			SC6.C6_PRCVEN,SC6.C6_QTDVEN
			
		UNION
		
		SELECT 
			SC5.C5_NUM PEDIDO,SC5.C5_CLIENTE CLIENTE,SC5.C5_LOJACLI LOJACLI,
			SC5.C5_TRANSP TRANSP,SC5.C5_EMISSAO DTAEMISSAO,SC5.C5_VEND1 VENDEDOR,
			SC5.C5_CONDPAG CONDPAG,SC6.C6_ITEM ITEM, SC6.C6_PRODUTO PRODUTO,
			SC6.C6_DESCRI DESCPROD,SC6.C6_XPACK PACK,SC6.C6_LOCAL ARMAZEM,
			SC6.C6_ENTREG DTAENTREGA,SC6.C6_PRCVEN PRCVEN,
			0 QTDVEND,0 QTDFATU,SC6.C6_QTDVEN QTDCANCE,0 QTDLIB, 0 SALDO
		FROM
			SC5010 SC5
			
			INNER JOIN SC6010 SC6 ON SC6.C6_FILIAL = SC5.C5_FILIAL AND SC6.C6_NUM = SC5.C5_NUM AND 
			SC6.C6_PRODUTO BETWEEN '' AND 'ZZZZZZZZZZZZZZZZZZZZ' AND SC6.C6_ENTREG BETWEEN '20130101' AND '20130314' AND 
			SC6.C6_BLQ = 'R' AND SC6.C6_XCANC = 'S' AND SC6.D_E_L_E_T_ = ''
			
		WHERE	
		SC5.C5_FILIAL = '05' AND 
		SC5.C5_NUM BETWEEN '' AND 'ZZZZZZ' AND
		SC5.C5_CLIENTE BETWEEN '' AND 'ZZZZZZZZ' AND
		SC5.C5_LOJACLI BETWEEN '' AND 'ZZ' AND 
		SC5.C5_VEND1 BETWEEN '000001' AND '000001' AND 
		SC5.D_E_L_E_T_ = ''
		GROUP BY 
			SC5.C5_NUM, SC5.C5_CLIENTE, SC5.C5_LOJACLI,
			SC5.C5_TRANSP, SC5.C5_EMISSAO, SC5.C5_VEND1,
			SC5.C5_CONDPAG, SC6.C6_ITEM, SC6.C6_PRODUTO,
			SC6.C6_DESCRI,SC6.C6_XPACK,SC6.C6_LOCAL, SC6.C6_ENTREG, 
			SC6.C6_PRCVEN,SC6.C6_QTDVEN
			
		UNION
		
		SELECT 
			SC5.C5_NUM PEDIDO,SC5.C5_CLIENTE CLIENTE,SC5.C5_LOJACLI LOJACLI,
			SC5.C5_TRANSP TRANSP,SC5.C5_EMISSAO DTAEMISSAO,SC5.C5_VEND1 VENDEDOR,
			SC5.C5_CONDPAG CONDPAG,SC6.C6_ITEM ITEM, SC6.C6_PRODUTO PRODUTO,
			SC6.C6_DESCRI DESCPROD,SC6.C6_XPACK PACK,SC6.C6_LOCAL ARMAZEM,
			SC6.C6_ENTREG DTAENTREGA,SC6.C6_PRCVEN PRCVEN,
			0 QTDVEND,0 QTDFATU,0 QTDCANCE,SUM(SC9.C9_QTDLIB) QTDLIB, 0 SALDO
		FROM
			SC5010 SC5
			
			INNER JOIN SC6010 SC6 ON SC6.C6_FILIAL = SC5.C5_FILIAL AND SC6.C6_NUM = SC5.C5_NUM AND 
			SC6.C6_PRODUTO BETWEEN '' AND 'ZZZZZZZZZZZZZZZZZZZZ' AND SC6.C6_ENTREG BETWEEN '20130101' AND '20130314' AND 
			SC6.C6_BLQ <> 'R' AND SC6.C6_XCANC <> 'S' AND SC6.D_E_L_E_T_ = ''
			
			INNER JOIN SC9010 SC9 ON SC9.C9_FILIAL = SC5.C5_FILIAL AND SC9.C9_PEDIDO = SC5.C5_NUM AND
			SC9.C9_PRODUTO = SC6.C6_PRODUTO AND SC9.C9_ITEM = SC6.C6_ITEM AND SC9.C9_NFISCAL = '' AND SC9.D_E_L_E_T_ = ''
		WHERE	
		SC5.C5_FILIAL = '05' AND 
		SC5.C5_NUM BETWEEN '' AND 'ZZZZZZ' AND
		SC5.C5_CLIENTE BETWEEN '' AND 'ZZZZZZZZ' AND
		SC5.C5_LOJACLI BETWEEN '' AND 'ZZ' AND 
		SC5.C5_VEND1 BETWEEN '000001' AND '000001' AND 
		SC5.D_E_L_E_T_ = ''
		GROUP BY 
			SC5.C5_NUM, SC5.C5_CLIENTE, SC5.C5_LOJACLI,
			SC5.C5_TRANSP, SC5.C5_EMISSAO, SC5.C5_VEND1,
			SC5.C5_CONDPAG, SC6.C6_ITEM, SC6.C6_PRODUTO,
			SC6.C6_DESCRI, SC6.C6_XPACK, SC6.C6_LOCAL, SC6.C6_ENTREG, 
			SC6.C6_PRCVEN
			
		UNION
		
		SELECT 
			SC5.C5_NUM PEDIDO,SC5.C5_CLIENTE CLIENTE,SC5.C5_LOJACLI LOJACLI,
			SC5.C5_TRANSP TRANSP,SC5.C5_EMISSAO DTAEMISSAO,SC5.C5_VEND1 VENDEDOR,
			SC5.C5_CONDPAG CONDPAG,SC6.C6_ITEM ITEM, SC6.C6_PRODUTO PRODUTO,
			SC6.C6_DESCRI DESCPROD,SC6.C6_XPACK PACK,SC6.C6_LOCAL ARMAZEM,SC6.C6_ENTREG DTAENTREGA,SC6.C6_PRCVEN PRCVEN,
			0 QTDVEND,SUM(SD2.D2_QUANT) QTDFATU,0 QTDCANCE,0 QTDLIB, 0 SALDO
		FROM
			SC5010 SC5
			
			INNER JOIN SC6010 SC6 ON SC6.C6_FILIAL = SC5.C5_FILIAL AND SC6.C6_NUM = SC5.C5_NUM AND 
			SC6.C6_PRODUTO BETWEEN '' AND 'ZZZZZZZZZZZZZZZZZZZZ' AND SC6.C6_ENTREG BETWEEN '20130101' AND '20130314' AND 
			SC6.C6_BLQ <> 'R' AND SC6.C6_XCANC <> 'S' AND SC6.D_E_L_E_T_ = ''
			
			INNER JOIN SD2010 SD2 ON SD2.D2_FILIAL = SC5.C5_FILIAL AND SD2.D2_PEDIDO = SC5.C5_NUM AND 
			SD2.D2_COD = SC6.C6_PRODUTO AND SD2.D2_ITEMPV = SC6.C6_ITEM AND SD2.D_E_L_E_T_ = ''
			
		WHERE	
		SC5.C5_FILIAL = '05' AND 
		SC5.C5_NUM BETWEEN '' AND 'ZZZZZZ' AND
		SC5.C5_CLIENTE BETWEEN '' AND 'ZZZZZZZZ' AND
		SC5.C5_LOJACLI BETWEEN '' AND 'ZZ' AND 
		SC5.C5_VEND1 BETWEEN '000001' AND '000001' AND 
		SC5.D_E_L_E_T_ = ''
		GROUP BY 
			SC5.C5_NUM, SC5.C5_CLIENTE, SC5.C5_LOJACLI,
			SC5.C5_TRANSP, SC5.C5_EMISSAO, SC5.C5_VEND1,
			SC5.C5_CONDPAG, SC6.C6_ITEM, SC6.C6_PRODUTO,
			SC6.C6_DESCRI, SC6.C6_XPACK,SC6.C6_ENTREG, SC6.C6_LOCAL,
			SC6.C6_PRCVEN
			
	)REPRE
GROUP BY	PEDIDO,CLIENTE,LOJACLI,TRANSP,DTAEMISSAO,VENDEDOR,CONDPAG,
			ITEM,PRODUTO,DESCPROD,PACK,ARMAZEM,DTAENTREGA,PRCVEN
ORDER BY VENDEDOR,PEDIDO,ITEM,PRODUTO	
