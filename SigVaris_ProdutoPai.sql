SELECT
	CODIGO, 
	CODMARCA, 
	NOME, 
	TIUTLO, 
	SUBTITULO, 
	CATEGO01,   
	CATEGO02,   
	CATEGO03,  
	CATEGO04,  
	CATEGO05,  
	IDPROD,
	IDLOJA,
	DESCECO, 
	DESCCARA, 
	KEYWORDS, 
	STATUSPRD, 
	TPPROD, 
	RECNOB5,
	RECNOWS5
FROM
(
	SELECT 
		B5.B5_COD CODIGO, 
		ISNULL(AY2.AY2_IDMARC,0) CODMARCA, 
		B5.B5_XNOMPRD NOME, 
		B5.B5_XTITULO TIUTLO, 
		B5.B5_XSUBTIT SUBTITULO, 
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B5.B5_XCAT01 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO01,   
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B5.B5_XCAT02 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO02,   
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B5.B5_XCAT03 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO03,  
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B5.B5_XCAT04 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO04,  
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B5.B5_XCAT05 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO05,   
		B5.B5_XIDPROD IDPROD,
		B5.B5_XIDLOJA IDLOJA,
		ISNULL(CAST(CAST(B5.B5_XDESCRI AS BINARY(2048)) AS VARCHAR(2048)),'') DESCECO, 
		ISNULL(CAST(CAST(B5.B5_XCARACT AS BINARY(2048)) AS VARCHAR(2048)),'') DESCCARA, 
		ISNULL(CAST(CAST(B5.B5_XKEYWOR AS BINARY(2048)) AS VARCHAR(2048)),'') KEYWORDS, 
		B5.B5_XSTAPRD STATUSPRD, 
		B5.B5_XTPPROD TPPROD, 
		B5.R_E_C_N_O_ RECNOB5,
		0 RECNOWS5 
	FROM 
		SB5010 B5 
		LEFT OUTER JOIN AY2010 AY2 ON AY2.AY2_FILIAL = '' AND AY2.AY2_CODIGO = B5.B5_XCODMAR AND AY2.D_E_L_E_T_ = ''
	WHERE 
		B5.B5_FILIAL = '0101' AND  
		B5.B5_XENVECO = '1' AND 
		B5.B5_XENVSKU = '1' AND 
		B5.B5_XUSAECO = 'S' AND 
		B5.D_E_L_E_T_ = '' 
	
	UNION 

	SELECT 
		WS5.WS5_CODPRD CODIGO, 
		AY2.AY2_IDMARC CODMARCA, 
		WS5.WS5_NOMPRD NOME, 
		WS5.WS5_TITULO TIUTLO, 
		WS5.WS5_SUBTIT SUBTITULO, 
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = WS5.WS5_CAT1 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO01,   
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = WS5.WS5_CAT2 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO02,   
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = WS5.WS5_CAT3 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO03,  
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = WS5.WS5_CAT4 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO04,  
		ISNULL((SELECT AY0.AY0_IDCAT FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = WS5.WS5_CAT5 AND AY0.D_E_L_E_T_ = '' ),0) CATEGO05,  
		WS5.WS5_IDPROD IDPROD,
		WS5.WS5_IDLOJA IDLOJA,
		ISNULL(CAST(CAST(WS5.WS5_DESCRP AS BINARY(2048)) AS VARCHAR(2048)),'') DESCECO, 
		ISNULL(CAST(CAST(WS5.WS5_CARACT AS BINARY(2048)) AS VARCHAR(2048)),'') DESCCARA, 
		ISNULL(CAST(CAST(WS5.WS5_KEYWOR AS BINARY(2048)) AS VARCHAR(2048)),'') KEYWORDS, 
		WS5.WS5_STATUS STATUSPRD, 
		WS5.WS5_TPPROD TPPROD, 
		0 RECNOB5,
		WS5.R_E_C_N_O_ RECNOWS5 
	FROM 
		WS5010 WS5 
		LEFT OUTER JOIN AY2010 AY2 ON AY2.AY2_FILIAL = '' AND AY2.AY2_CODIGO = WS5.WS5_CODMA AND AY2.D_E_L_E_T_ = ''
	WHERE 
		WS5.WS5_FILIAL = '' AND  
		WS5.WS5_ENVECO = '1' AND 
		WS5.WS5_USAECO = 'S' AND 
		WS5.D_E_L_E_T_ = '' 

) PRDPAI
ORDER BY CODIGO
