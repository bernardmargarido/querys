SELECT 
	DISTINCT(B4.B4_COD),
	B4.B4_DESC,
	( SELECT AY1.AY1_CATFIL FROM AY1010 AY1 WHERE AY1.AY1_FILIAL = '' AND AY1.AY1_SUBCAT = B4.B4_01CAT1 AND AY1.D_E_L_E_T_ = '' ) CATNV1,
	( SELECT AY1.AY1_CATFIL FROM AY1010 AY1 WHERE AY1.AY1_CODIGO = B4.B4_01CAT1 AND AY1.AY1_SUBCAT = B4.B4_01CAT2 AND AY1.D_E_L_E_T_ = '' ) CATNV2,
	( SELECT AY1.AY1_CATFIL FROM AY1010 AY1 WHERE AY1.AY1_CODIGO = B4.B4_01CAT1 AND AY1.AY1_SUBCAT = B4.B4_01CAT3 AND AY1.D_E_L_E_T_ = '' ) CATNV3,
	( SELECT AY1.AY1_CATFIL FROM AY1010 AY1 WHERE AY1.AY1_CODIGO = B4.B4_01CAT1 AND AY1.AY1_SUBCAT = B4.B4_01CAT4 AND AY1.D_E_L_E_T_ = '' ) CATNV4,
	( SELECT AY1.AY1_CATFIL FROM AY1010 AY1 WHERE AY1.AY1_CODIGO = B4.B4_01CAT1 AND AY1.AY1_SUBCAT = B4.B4_01CAT5 AND AY1.D_E_L_E_T_ = '' ) CATNV5,
	B4.R_E_C_N_O_ RECNOSB4
FROM 
	SB4010 B4
	INNER JOIN SB1010 B1 ON B1.B1_FILIAL = '' AND SUBSTRING(B1.B1_COD,1,6) = B4.B4_COD AND B1_XENVECO = '2' AND B1.D_E_L_E_T_ = ''
WHERE
	B4.B4_FILIAL = '' AND 
	B4.B4_XENVECO = '2' AND
	B4.B4_XENVCAT = '1' AND
	B4.B4_XUSAECO = 'S' AND 
	B4.D_E_L_E_T_ = ''
