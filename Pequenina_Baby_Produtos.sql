SELECT 
	B1.B1_01CODFO,
	B4.B4_COD,
	B4.B4_DESC,
	B1.B1_COD,
	( SELECT AY0_DESC FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B4.B4_01CAT1 AND AY0.D_E_L_E_T_ = '' ) CAT_01,
	( SELECT AY0_DESC FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B4.B4_01CAT2 AND AY0.D_E_L_E_T_ = '' ) CAT_02,
	( SELECT AY0_DESC FROM AY0010 AY0 WHERE AY0.AY0_FILIAL = '' AND AY0.AY0_CODIGO = B4.B4_01CAT3 AND AY0.D_E_L_E_T_ = '' ) CAT_03,
	B1.B1_01CLGRD,
	(SELECT BV.BV_DESCRI FROM SBV010 BV WHERE BV.BV_FILIAL = '01' AND BV.BV_CHAVE = B1.B1_01CLGRD AND BV.BV_TABELA = '02' AND BV.D_E_L_E_T_ = ''  ) DESCCOL,
	B1.B1_01LNGRD,
	(SELECT BV.BV_DESCRI FROM SBV010 BV WHERE BV.BV_FILIAL = '01' AND BV.BV_CHAVE = B1.B1_01LNGRD AND BV.BV_TABELA = '01' AND BV.D_E_L_E_T_ = '') DESCLIN,
	ISNULL(DA1.DA1_PRCVEN,0) PRECO,
	ISNULL(B2.B2_CM1,0) CUSTO,
	ISNULL(B2.B2_QATU,0) SALDO,
	ISNULL(ROUND( ( (DA1.DA1_PRCVEN - B2.B2_CM1) / DA1.DA1_PRCVEN) * 100,2),0) PRCPER
FROM 
	SB4010 B4
	INNER JOIN SB1010 B1 ON B1.B1_FILIAL = '' AND B1.B1_01PRODP = B4.B4_COD AND B1.D_E_L_E_T_ = ''
	LEFT OUTER JOIN SB2010 B2 ON B2.B2_FILIAL = '0101' AND B2.B2_COD = B1.B1_COD AND B2.B2_LOCAL = '01' AND B2.D_E_L_E_T_ = ''
	LEFT OUTER JOIN DA1010 DA1 ON DA1.DA1_FILIAL = '0101' AND DA1.DA1_REFGRD = B4.B4_COD AND DA1.D_E_L_E_T_ = ''
WHERE 
	B4.D_E_L_E_T_ = '' AND 
	B4.B4_01CODMA IN('000001')
ORDER BY B4.B4_COD